---
title: 'Google Sign-In'
---

Modelence supports OAuth authentication with Google, allowing users to sign in with their Google accounts.

## Prerequisites

Before implementing Google Sign-In, you need to:

1. Create a project in the [Google Cloud Console](https://console.cloud.google.com/)
2. Configure the OAuth consent screen
3. Create OAuth 2.0 credentials (Client ID and Client Secret)
4. Configure authorized redirect URIs

## Google Cloud Console Setup

1. **Create a Project**
   - Go to [Google Cloud Console](https://console.cloud.google.com/)
   - Click "Select a project" → "New Project"
   - Name your project and click "Create"

2. **Configure OAuth Consent Screen**
   - Go to "APIs & Services" → "OAuth consent screen"
   - Choose user type (External for most applications)
   - Fill in the required fields:
     - App name
     - User support email
     - Developer contact information
   - Click "Save and Continue"
   - Add scopes if needed (profile and email are included by default)
   - Click "Save and Continue"

3. **Create OAuth Credentials**
   - Go to "APIs & Services" → "Credentials"
   - Click "Create Credentials" → "OAuth client ID"
   - Select "Web application" as the application type
   - Add a name for your OAuth client

4. **Configure Redirect URIs**
   - Under "Authorized JavaScript origins", add:
     - `http://localhost:3000` (for local development)
     - `https://yourdomain.com` (for production)
   - Under "Authorized redirect URIs", add:
     - `http://localhost:3000/api/_internal/auth/google/callback` (for local development)
     - `https://yourdomain.com/api/_internal/auth/google/callback` (for production)
   - Click "Create"

5. **Save Credentials**
   - Copy your **Client ID** and **Client Secret**
   - Store them securely (use environment variables or Modelence Cloud config)

## Server-Side Configuration

Google Sign-In is built into Modelence and requires no additional packages.

### Option 1: Modelence Cloud (Recommended)

The preferred way to configure Google authentication is through [Modelence Cloud](https://cloud.modelence.com/):

1. Go to [https://cloud.modelence.com/](https://cloud.modelence.com/)
2. Navigate to your project
3. Go to **Authentication → Providers → Google**
4. Enable Google authentication
5. Enter your **Client ID** and **Client Secret** from Google Cloud Console
6. Save the configuration

This approach allows you to manage your configuration centrally through an intuitive UI and keeps sensitive credentials secure.

### Option 2: Environment Variables

Alternatively, you can use environment variables. Create a `.env` file in your project root:

```bash
MODELENCE_AUTH_GOOGLE_ENABLED=true
MODELENCE_AUTH_GOOGLE_CLIENT_ID=your-client-id.apps.googleusercontent.com
MODELENCE_AUTH_GOOGLE_CLIENT_SECRET=your-client-secret
```

Make sure to add `.env` to your `.gitignore` file to keep credentials secure.

The Google authentication is automatically enabled when these configurations are set. No additional server code is needed.

## Client-Side Implementation

### Using @modelence/auth-ui (Recommended)

The easiest way to add Google Sign-In is using the `@modelence/auth-ui` package, which provides a complete `LoginForm` component with built-in Google authentication support:

```bash
npm install @modelence/auth-ui
```

Then use the `LoginForm` component:

```typescript
import { LoginForm } from '@modelence/auth-ui';

function LoginPage() {
  return <LoginForm />;
}
```

The `LoginForm` component automatically displays a "Sign in with Google" button when Google authentication is enabled from the **Authentication → Google** section in [cloud.modelence.com](https://cloud.modelence.com) or via the `MODELENCE_AUTH_GOOGLE_ENABLED` environment variable. The component includes:
- Pre-styled button with Google branding and icon
- Automatic redirect handling
- Email/password login form
- Responsive design with dark mode support
- Forgot password and sign-up links

You can customize the form with various props:

```typescript
<LoginForm
  buttonVariant="outline"     // or "default", "secondary", "ghost"
  buttonSize="lg"             // or "default", "sm"
  cardClassName="shadow-lg"   // Custom card styling
  onSignup={() => navigate('/signup')}
  onForgotPassword={() => navigate('/forgot-password')}
/>
```

## How Google Sign-In Works

1. **Initiation** - User clicks "Sign in with Google" button
2. **Redirect** - User is redirected to Google's OAuth consent screen
3. **Authorization** - User grants permission to your app
4. **Callback** - Google redirects back to your app with an authorization code
5. **Token Exchange** - Your server exchanges the code for user information
6. **User Creation/Login** - If user doesn't exist, a new account is created; otherwise, user is logged in
7. **Session Creation** - A session is established and the user is authenticated

## User Data Handling

When a user signs in with Google, Modelence automatically:

- Creates a user account if one doesn't exist
- Links the Google account to the user profile
- Retrieves profile information (name, email, profile picture)
- Marks the email as verified (since Google has verified it)

The user object will contain:

```typescript
{
  email: string;           // Google account email
  handle: string;          // Generated from email or name
  emailVerified: true;     // Always true for Google sign-in
  googleId: string;        // Google user ID
  name?: string;           // Full name from Google
  picture?: string;        // Profile picture URL
}
```

## Manual Implementation (Alternative)

If you prefer not to use `@modelence/auth-ui`, you can manually implement Google Sign-In by redirecting to the authentication endpoint:

```typescript
function handleGoogleSignIn() {
  // Redirect to Google OAuth flow
  window.location.href = '/api/_internal/auth/google';
}
```

Example with a custom button:

```typescript
function LoginForm() {
  return (
    <div>
      <h2>Sign In</h2>
      <button onClick={() => window.location.href = '/api/_internal/auth/google'}>
        Sign in with Google
      </button>
    </div>
  );
}
```

## Troubleshooting

**Redirect URI Mismatch Error**
- Ensure the redirect URI in Google Cloud Console exactly matches your application URL
- Check for trailing slashes and http vs https
- Common format: `https://yourdomain.com/api/_internal/auth/google/callback`

**Invalid Client Error**
- Verify your Client ID and Client Secret are correct
- Check that environment variables are properly loaded
- Ensure credentials are from the correct Google Cloud project

**Access Blocked: Authorization Error**
- Make sure Google+ API is enabled in your project
- Verify your OAuth consent screen is configured
- Check that your domain is authorized

